<!DOCTYPE html>
<html lang="hu">
<head>
  <title>borospince</title>
  <meta name="description" content="Seg√©dlet a bekeverend≈ë k√©nmennyis√©g kisz√°mol√°s√°ra: adott a must, cefre vagy bor t√©rfogata, amihez a megfelel≈ë mennyis√©g≈± SO2 tartalm√∫ anyagot adagolva a k√≠v√°nt k√©n-dioxid szint be√°ll√≠that√≥.">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/borok/styles_cs2020.css?v=l">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined">
  <link rel="icon" href="/src_home/favicon.ico" type="image/gif" sizes="65x65">
</head>
<style>
#fejlec {resize:none;overflow:hidden;}
#info {resize:none;}
.balra {
  display: flex;
  flex-flow: row;
  width: inherit;
  height: auto;
  justify-content: flex-start;
}
</style>
<body>
  <div id="overlay"><p id="forgo" class="loader"></p></div>
  <div class="active-footer">
    <a onclick="window.scrollTo(0,0);"><span class="back-to-top"><span class="material-icons-outlined">&#xe5ce;</span></span></a>
  </div>
  <section id="container_cs2020">
    <div class="nav-wrapper">
      <div class="left-side">
        <div id="bigyo">
          <div id="home" class="nav-link-wrapper" >
            <a href="/index.html"><span class="material-icons-outlined">&#xe88a;</span></a>
          </div>
          <table><tr><td id="holtart">üìù</td></tr></table>
        </div>
        <select name="tech"></select>
      </div>
    </div>
    <div class="content">
      <div id="tartalom" class="box" style="display:none">
        <div class="box-text-update">
          <p>
            Fontos figyelmeztet√©s!
            <br>
            Olyan megold√°s sz√ºletett e seg√©dlet l√©trehoz√°s√°n√°l, ami haszn√°lja a szem√©lyis√©gi jogaikra √©rz√©keny polg√°rok nyugalm√°nak megzavar√°s√°ra alkalmas, h√≠rhedten f√©lelmetes, √©s ez√©rt a <a href="https://eur-lex.europa.eu/legal-content/HU/TXT/?uri=CELEX%3A32016R0679&qid=1672580877783">GDPR</a>-ben szab√°lyozott "<a href="https://hu.wikipedia.org/wiki/HTTP-s%C3%BCti">cookie</a>" technik√°t.
            Azonban itt kiv√©telesen nem statisztikai- vagy marketigc√©lokra t√°rolok adatokat a b√∂ng√©sz≈ët futtat√≥ eszk√∂z√∂n (sz√°m√≠t√≥g√©p, laptop, okostelefon, tablet stb.), hanem kiz√°r√≥lag a k√©nezend≈ë t√©telekkel kapcsolatosan.
            Az√©rt, hogy ezek k√©s≈ëbb jegyzet gyan√°nt rendelkez√©sre √°lljanak.
            <br>
            Ha nem szeretn√©l ilyet, akkor hagyd el ezt a weboldalt.
          </p>
        </div>
        <div class="box-text">
          <p>
            Must vagy cefre k√©nez√©s√©n√©l nincs sz√ºks√©g magas tudom√°nyokra, se laborvizsg√°latra. Adott a kezelend≈ë anyag t√©rfogata, amihez a megfelel≈ë mennyis√©g≈± SO<sub>2</sub> tartalm√∫ anyagot keverve a k√≠v√°nt k√©n-dioxid szint be√°ll√≠that√≥.
            Sz√©ls≈ës√©gesen egyszer≈± feladat, mert null√°r√≥l indulva, SO<sub>2</sub> tartalom hi√°ny√°ban kell meghat√°rozni a k√©nez≈ëanyag m√©rt√©k√©t.
            <br>
            Bonyol√≥dik az √ºgy, ha elillant vagy lek√∂t√∂tt SO<sub>2</sub> p√≥tl√°s√°ra adagoln√°m a hi√°nyz√≥ mennyis√©get. Ennek els≈ë l√©p√©se a m√©r√©s, a jelenlegi szabad k√©n-dioxid szint meg√°llap√≠t√°sa.
            Ekkor az el√©rend≈ë szint √©s a m√©r√©si eredm√©ny k√ºl√∂nbs√©ge az egyik t√©nyez≈ë abban a k√©pletben, amiben szerepel a k√©nezend≈ë t√©tel mennyis√©ge, √©s a k√©nez√©shez haszn√°lt anyag t√∂m√©nys√©ge is.
            <br>
            ‚ö†Ô∏èA megc√©lzott szint el√©r√©s√©hez a kisz√°molt mennyis√©g dupl√°j√°t kell adagolni.‚ö†Ô∏è<br>
            Mi√©rt? Mert kb. a fele azonnal lek√∂t≈ëdik. A k√©nez≈ëadag kisz√°molt mennyis√©ge egy ide√°lis, puszt√°n matematikai alapon nyugv√≥ vil√°gban √©rv√©nyes elm√©leti √©rt√©k,
            de a mi t√∂k√©letlen vil√°gunkban a k√©mi√°nak is van jelent≈ës√©ge, ez√©rt a folyamatokra gyakorolt hat√°s√°t nem hagyhatjuk figyelmen k√≠v√ºl. Ha nem veszed figyelembe ezt az aj√°nl√°st, akkor <a href="/borok/04.html#:~:text=2023.%20janu%C3%A1r%2031.-,Nem%20el%C3%A9g%20a%20matek,-.%20Bor%C3%A1szathoz%20elengedhetetlen%20a">√∫gy j√°rsz, mint √©n.</a>
          </p>
        </div>
        <div class="box-text">
          <fieldset>
            <legend>alapadatok</legend>
            <table border="0" cellspacing="0" cellpadding="3">
              <tr>
                <td align="right">d√°tum</td>
                <td>
                  <input id="dtm" name="dtm" type="text" size="11" disabled />
                  <input id="dt" name="dt" type="number" disabled style="display:none" />
                </td>
              </tr>
              <tr>
                <td align="right">t√©tel neve</td>
                <td>
                  <input id="nev" name="nev" type="text" size="11" maxlength="11" />
                </td>
              </tr>
              <tr>
                <td align="right">√°llapot</td>
                <td>
                  <select id="mit" name="mit" style="font-size:large">
                  </select>
                </td>
              </tr>
              <tr>
                <td align="right">k√©nez≈ëanyag</td>
                <td>
                  <select id="mivel" name="mivel" style="font-size:large">
                  </select>
                </td>
              </tr>
              <tr>
                <td align="right">t√∂m√©nys√©g (%)</td>
                <td>
                  <input type="range" id="tomeny_r" min="1" max="100" value="5" oninput="tomeny.value=this.value" />
                  <input type="number" id="tomeny" name="tomeny" min="1" max="100" value="5" oninput="tomeny_r.value=this.value" />
                </td>
              </tr>
              <tr id="jelenleg" style="display:none">
                <td align="right">jelenlegi SO<sub>2</sub> szint (mg/l)</td>
                <td>
                  <input type="range" id="jelen_r" min="0" max="200" value="0" oninput="jelen.value=this.value" />
                  <input type="number" id="jelen" name="jelen" min="0" max="200" value="0" oninput="jelen_r.value=this.value" />
                </td>
              </tr>
              <tr>
                <td align="right">el√©rend≈ë SO<sub>2</sub> szint (mg/l)</td>
                <td>
                  <input type="range" id="eler_r" min="1" max="200" value="40" oninput="eler.value=this.value" />
                  <input type="number" id="eler" name="eler" min="1" max="200" value="40" oninput="eler_r.value=this.value" />
                </td>
              </tr>
              <tr>
                <td align="right">k√©nezend≈ë mennyis√©g (liter)</td>
                <td>
                  <input type="range" id="mennyi_r" min="1" max="999" value="100" oninput="mennyi.value=this.value" />
                  <input type="number" id="mennyi" name="mennyi" min="1" max="999" value="100" oninput="mennyi_r.value=this.value" />
                </td>
              </tr>
            </table>
          </fieldset>
        </div>
        <button id="szamol" class="nagybutton" disabled>sz√°mol√°s</button>
        <textarea class="tarea teljes" id="fejlec" readonly="readonly" rows="1" wrap="off"></textarea>
        <textarea class="tarea teljes" id="info" readonly="readonly" rows="12" wrap="off"></textarea>
        <br>
        <div class="box-text">
          <p>
            Nem mer√ºl ki ennyiben a seg√©dlet "funkci√≥gazdags√°ga", mert sz≈±rhet≈ë a jegyzet.
            Ennek persze akkor van jelent≈ës√©ge, ha tekint√©lyes sz√°m√∫ k√©nez√©sr≈ël √°ll rendelkez√©sre adat.
          </p>
        </div>
        <div class="box-text">
          <fieldset>
            <legend id="csik">&#9657;</legend>
            <table border="0" cellspacing="0" cellpadding="3">
              <tr>
                <td align="right">ford√≠tott sz≈±r√©s&nbsp;</td>
                <td>
                  <input id="fordit" type="checkbox">
                </td>
              </tr>
              <tr>
                <td align="right">sz≈±r≈ë&nbsp;</td>
                <td>
                  <input id="szuro" type="text" size="11"/>
                </td>
              </tr>
              <tr>
                <td align="right">+sz≈±r≈ë&nbsp;</td>
                <td>
                  <input id="szuro2" type="text" size="11" disabled/>
                </td>
              </tr>
              <tr>
                <td align="right">megfelel&nbsp;</td>
                <td>
                  <div id="stimmel"></div>
                </td>
              </tr>
              <tr>
                <td align="right">lista t√∂rl√©se&nbsp;</td>
                <td>
                  <input id="enged" type="checkbox">
                  <button id="torol" disabled>kampec</button>
                </td>
              </tr>
            </table>
          </fieldset>
        </div>
        <div class="box-text">
          <p>
            Nincs mennyis√©gi korl√°tja a feljegyezhet≈ë adatok sz√°m√°nak, viszont az id≈ëbeli korl√°t <a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-rfc6265bis.html#attribute-expires">400 nap</a>, aminek eltelt√©vel a bejegyzett sor t√∂rl≈ëdik (<a href="https://en.wikipedia.org/wiki/Time_to_live">TTL</a>).
            A "lista t√∂rl√©se" lehet≈ës√©ggel azonnal elt√°vol√≠that√≥k a k√©nez√©si jegyzet list√°zott elemei. Ha ez egy sz≈±rt lista, akkor csup√°n a sz≈±r≈ënek megfelel≈ë t√©telekre vonatkozik, de sz≈±retlen list√°ra alkalmazva minden adat ugrik.
            Ugyan√≠gy elt√ºnteti az √∂sszes adatot a b√∂ng√©sz≈ë "cookie-k t√∂rl√©se" m≈±velet√©nek ind√≠t√°sa.
            A b√∂ng√©sz≈ëk inkognit√≥ √ºzemm√≥dj√°ban nem marad nyoma semminek, ez√©rt az ebben az √ºzemm√≥dban r√∂gz√≠tett k√©nez√©si adatokat sem ≈ërzi meg.
            <br>
            L√°tsz√≥lag nincs sok haszna a ford√≠tott sz≈±r√©snek, de ha p√©ld√°ul azokra a t√©telekre vagy k√≠v√°ncsi, amikhez nem t√©rfogatra (ml), hanem s√∫lyra (mg) adagoltad a k√©nez≈ëanyagot, akkor ez nem fog menni az "mg" szerinti sz≈±r√©ssel, mert az "mg/l" sz√∂veg minden sorban szerepel.
            Sz≈±rj "ml" szerint, majd vedd az eredm√©ny ford√≠tottj√°t, amikor minden olyan sor megjelenik a tal√°latok k√∂z√∂tt, amik nem tartalmazz√°k az "ml" sz√∂veget. √çgy m√°ris megvan a k√≠v√°nt eredm√©ny, amit "k√°lium"-ra sz≈±rve egyszer≈±bben is megkaphatsz, de az nem vil√°g√≠t r√° a ford√≠tott sz≈±r√©s l√©nyeg√©re.
            <br>
            Hasznos lehet egy ment√©s/bet√∂lt√©s funkci√≥, mert a <a href="https://support.google.com/chrome/answer/185277?hl=hu&co=GENIE.Platform%3DDesktop">szinkroniz√°l√°s</a> nem viszi √°t a cookie t√°r tartalm√°t egyik eszk√∂zr≈ël a m√°sikra.
          </p>
        </div>
        <button id="ment" class="nagybutton">ment√©s</button>
        <button id="betolt" class="nagybutton">bet√∂lt√©s</button>
        <div class="box-text">
          <p>
            Ez id≈ë szerint (2022dec) a bet√∂lt√©s a Chrome, Edge √©s Opera b√∂ng√©sz≈ëkben m≈±k√∂dik. A t√∂bbib≈ël (p√©ld√°ul Chrome for Android) hi√°nyzik a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/showOpenFilePicker"><code>showOpenFilePicker</code></a> API.
            √úres lista eset√©n nem szorul magyar√°zatra az adatok bet√∂lt√©s√©nek hat√°sa, ellenben l√©tez≈ë adatokra t√∂ltve √∂sszef√©s√ºl√∂m a k√©t k√©nez√©si adatsort azt az egyszer≈± szab√°lyt alkalmazva, hogy egy d√°tumhoz nem tartozhat t√∂bbsz√∂r ugyanaz a t√©tel n√©v, mint ahogy nem is k√©nezz√ºk ugyanazt naponta t√∂bbsz√∂r.
            Ilyen esetben a list√°ban l√©v≈ë marad, a file-b√≥l bet√∂lt√∂tt sor viszont nem lesz hasznos√≠tva.
            <br>
            Van a bet√∂lt√©snek egy mell√©khat√°sa: √∫jraindul a 400 napos sz√°ml√°l√≥ a bet√∂lt√∂tt adat t√∂rl≈ëd√©s√©ig.
          </p>
        </div>
      </div>
      <div id="ertekel" class="box" style="display:none">
        <div class="box-text">
          <p>
            M≈±k√∂d√©s√©t tekintve alapvet≈ëen el√©gedett vagyok az eredm√©nnyel, b√°r szakmai (programoz√≥i) szemsz√∂gb≈ël vizsg√°lva egy kicsit rendetlen, mert az √∂tletek java menet k√∂zben sz√ºletett, ami az el≈ërel√°t√≥, alapos tervez√©s fon√°kja.
            Ebben a st√≠lusban is szabad alkotni, de kiterjedtebb, √∂sszetettebb munk√°n dolgozva √©rdemes napokig-hetekig gondolkodni √©s tervezni an√©lk√ºl, hogy ak√°r egy fia programsor keletkezne k√∂zben.
            B≈ëven megt√©r√ºl a megfontolt viselked√©s, amikor az alaposan √°tgondolt strukt√∫ra esetleges b≈ëv√≠t√©se, fejleszt√©se ker√ºl napirendre.
            <br><br>
            Egy eszesen tervezett rendszerben m√°r eleve megvan a helye mindennek, csak a r√©szletek kidolgoz√°sa v√°rat mag√°ra. Az aut√≥gy√°rt√≥k √∫jabban enn√©l is tov√°bbmennek.
            Nem csak a hely√©t tervezik be bizonyos extra alkatr√©szeknek, hanem ‚Äì n√©mi kock√°zatot v√°llalva ‚Äì k√©retlen√ºl be√©p√≠tik a gy√°rt√°sn√°l. Azt√°n addig nem adnak hozz√°f√©r√©st, am√≠g a kuncsaft nem hajland√≥ <a href="https://www.bbc.com/news/technology-62142208">havi-</a> vagy <a href="https://www.bbc.com/news/technology-63743597">√©ves</a> d√≠jat fizetni √©rte.
            Nem √∫jdons√°g ez a fajta leh√∫z√°s. ≈êsi tal√°lm√°ny. Bizonyos n≈ëk is csak akkor szolg√°ltatnak lelkesen bizonyos f√©rjeknek, ha az a szerencs√©tlen rendszeresen "meglepi" ≈ëket valami apr√≥s√°ggal. Gy≈±r≈±, nyak√©k, kark√∂t≈ë, t√°ska, egzotikus utaz√°s, 800 kil√≥s sz√©f az emeleten ‚Äì mindegy, csak j√≥ dr√°ga √©s men≈ë legyen.
            K√ºl√∂nben megvonj√°k a hozz√°f√©r√©st a pin√°hoz, pedig ugye az gy√°rilag be van √©p√≠tve.
          </p>
        </div>
      </div>
      <div id="nincs_kapcsolat" class="box" style="display:none">
        <div class="box-text-update">
          <p>
            Jelenleg nem lehet kapcsol√≥dni a szolg√°ltat√°shoz. Pr√≥b√°lkozz k√©s≈ëbb, rem√©lhet≈ëleg javulnak a k√∂r√ºlm√©nyek.
          </p>
        </div>
      </div>
    </div>
    <div class="footer"></div>
  </section>    
</body>
</html>
<script>
  var csomag = null;
  var time_out = null;
  var exp_tick = null;
  var betakarva = false;
  var adag_tb = [];
  var jel_tb = [];
  var jel_tb2 = [];
  var cookie_eloke = "k√©n:";
  var ttl_nap = 400;

  const download = (path, file_nev) => {
    const kamu = document.createElement('a');
    kamu.href = path;
    kamu.download = file_nev;
    document.body.appendChild(kamu);
    kamu.click();
    document.body.removeChild(kamu);
    window.alert(file_nev+" n√©ven mentve");
  }

  function mentes() {
    const data = JSON.stringify(adag_tb,null,2);
    const blob = new Blob([data],{type:'application/json'});
    const url = URL.createObjectURL(blob);
    download(url,'k√©nez√©si_adatok.json');
    URL.revokeObjectURL(url);
  }

  var ment = document.getElementById("ment");
  ment.addEventListener("click",mentes);

  function adag_kulcs(dat) {
    return cookie_eloke+dat.dtm+'.'+dat.nev;
  }

  function kulcs_index(kulcs) {
    var i = 0;
    var talalt = false;
    while (i < adag_tb.length && !talalt) {
      talalt = (kulcs == adag_kulcs(adag_tb[i]));
      i++;
    }
    if (talalt) return i-1;
      else return -1;
  }

  function adag_tarol(dat) {
    var d = new Date();
    dat.lejarat = d.getTime() + (ttl_nap*86400000);
    d.setTime(dat.lejarat);
    var expires = "expires="+ d.toUTCString();
    adag_tb.push(dat);
    document.cookie = adag_kulcs(dat) + "=" + JSON.stringify(dat) + ";" + expires + ";path=/";
  }

  function megfelel(i) {
    if (jel_tb2.length > 0) {
      return jel_tb2[i];
    } else return jel_tb[i];
  }

  function ttl(t) {
    var d = new Date();
    return Math.floor((t-d.getTime())/86400000).toString().padStart(6,' ')+"  ";
  }

  function adag_sorok(dat) {
    if ((dat != undefined) && (dat.sor != "")) {
      info.innerHTML += dat.sor+ttl(dat.lejarat)+"\n";
    } else {
      info.innerHTML = "";
      for (var i = 0; i < adag_tb.length; i++)
        if (megfelel(i)) info.innerHTML += adag_tb[i].sor+ttl(adag_tb[i].lejarat)+"\n";
    }
    info.scrollTop = info.scrollHeight;
    info.focus();
  }

  var betolt = document.getElementById("betolt");
  const pick_opt = {
    types: [{description:'JSON',accept:{'json/*': ['.json']}}],
    excludeAcceptAllOption: true,
    startIn: 'downloads',
    multiple: false
  }
  betolt.addEventListener("click", async () => {
    var fileHandle;
    [fileHandle] = await window.showOpenFilePicker(pick_opt);
    const file = await fileHandle.getFile();
    const szoveg = await file.text();
    try {
      var kihagyott_db = 0;
      var alap_db = adag_tb.length;
      var json = JSON.parse(szoveg);
      for (var i = 0; i < json.length; i++) {
        if (kulcs_index(adag_kulcs(json[i])) < 0) adag_tarol(json[i]);
          else kihagyott_db++;
      }
      if (adag_tb.length > alap_db) {
        adag_tb.sort(function(a,b) {
          if(a.dtm > b.dtm) return 1;
          if(a.dtm < b.dtm) return -1;
          return 0;
        });
        szuro_nullaz();
        adag_sorok();
      }
      window.alert((adag_tb.length-alap_db)+" k√©nezett t√©tel helyret√©ve, "+kihagyott_db+" kihagyva");
    } catch(hiba) {window.alert(hiba)}
  });

  var fejlec = document.getElementById("fejlec");
  var info = document.getElementById("info");
  info.onscroll = function (e) {
    //fejlec.scrollTop = info.scrollTop;
    fejlec.scrollLeft = info.scrollLeft;
  };

  function helyben_tarolt_adatok_cookiebol() {
    try {
      var adagok = document.cookie.split(";");
      for (var i = 0; i < adagok.length; i++) {
        if (adagok[i].trim().indexOf(cookie_eloke) == 0) {
          var p = adagok[i].indexOf('=');
          adag_tb.push(JSON.parse(adagok[i].substring(p+1)));
        }
      }
      adag_tb.sort(function(a,b) {
        if(a.dtm > b.dtm) return 1;
        if(a.dtm < b.dtm) return -1;
        return 0;
      });
      for (var i = 0; i < adag_tb.length; i++) jel_tb.push(true);
      adag_sorok();
    } catch(hiba) {window.alert("nem siker√ºlt beolvasni a helyben t√°rolt k√©nez√©si adatokat")};
  }
  
  var csik = document.getElementById("csik");
  var szuro = document.getElementById("szuro");
  var szuro2 = document.getElementById("szuro2");
  var stimmel = document.getElementById("stimmel");
  var fordit = document.getElementById("fordit");
  var enged = document.getElementById("enged");
  var torol = document.getElementById("torol");
  var sz_lmk = 12; //sz≈±rt lista megjelen√©s k√©sleltet√©se x100 ms
  var csik_hossz = 0;
  var cajger = null;
  var kesleltet = null;

  function kijelolt_db() {
    var db = 0;
    for (var i = 0; i < jel_tb.length; i++)
      if (megfelel(i)) db++;
    return db;
  }

  function talalat_db() {
    jel_tb = [];
    if (szuro.value != "") {
      var viszony = !fordit.checked;
      var db = 0;
      for (var i = 0; i < adag_tb.length; i++)
        if ((adag_tb[i].sor.indexOf(szuro.value) > -1) == viszony) {
          jel_tb.push(true);
          db++;
        } else jel_tb.push(false);
      stimmel.innerHTML = db+'/'+adag_tb.length+" sor";
    } else {
      stimmel.innerHTML = "mind ("+adag_tb.length+" sor)";
      for (var i = 0; i < adag_tb.length; i++) jel_tb.push(true);
    }
  }

  function talalat_db2() {
    jel_tb2 = [];
    if (szuro2.value != "") {
      var viszony = !fordit.checked;
      var db = kijelolt_db();
      for (var i = 0; i < adag_tb.length; i++) {
        jel_tb2.push(jel_tb[i]);
        if (jel_tb[i]) {
          if ((adag_tb[i].sor.indexOf(szuro2.value) > -1) != viszony) {
            jel_tb2[i] = false;
            db--;
          }
        }
      }
      stimmel.innerHTML = db+'/'+adag_tb.length+" sor";
    } else talalat_db();
  }

  function mutato() {
    if (csik_hossz > 1) {
      csik_hossz--;
      csik.innerHTML = ("&#9667;").repeat(csik_hossz);
    } else {
      clearInterval(cajger);
      csik.innerHTML = "&#9657;";
    }
  }

  function szuro_ugy() {
    if (cajger) clearInterval(cajger);
    if (kesleltet) clearTimeout(kesleltet);
    csik_hossz = sz_lmk;
    cajger = setInterval(mutato,100);
    kesleltet = setTimeout(adag_sorok,sz_lmk*100);
    torol.disabled = true;
    enged.checked = false;
  }

  function szuro_nullaz() {
    enged.checked = false;
    torol.disabled = true;
    szuro.value = "";
    szuro2.value = "";
    szuro2.disabled = true;
    talalat_db();
    talalat_db2();
  }

  szuro.addEventListener("input",function() {
    szuro.value = szuro.value.trim().toLowerCase();
    szuro_ugy();
    if (szuro.value == "") szuro_nullaz();
      else szuro2.disabled = false;
    talalat_db();
  });

  szuro2.addEventListener("input",function() {
    szuro2.value = szuro2.value.trim().toLowerCase();
    szuro_ugy();
    talalat_db2();
  });

  fordit.addEventListener("change",function() {
    if (szuro.value != "") {
      talalat_db();
      talalat_db2();
      adag_sorok();
    }
  });

  enged.addEventListener("change",function() {
    torol.disabled = (!enged.checked || (kijelolt_db() == 0));
  });

  torol.addEventListener("click",function() {
    var torolt_db = 0;
    try {
      for (var i = adag_tb.length-1; i > -1; i--)
        if (megfelel(i)) {
          cookieStore.delete(adag_kulcs(adag_tb[i]));
          adag_tb.splice(i,1);
          torolt_db++;
        }
      szuro_nullaz();
      adag_sorok();
      window.alert(torolt_db+" sor t√∂r√∂lve");
    } catch(hiba) {window.alert(hiba)}
  });

  var nev = document.getElementById("nev");
  nev.addEventListener("input",function() {
    nev.value = nev.value.trim().toLowerCase();
    szamol.disabled = (nev.value == "");
  });

  function input_adatok() {
    var inputok = document.getElementsByTagName("*");
    var dat = {};
    var mezo;
    var i;
    for (i = 0; i < inputok.length; i++) {
      mezo = inputok[i];
      if (mezo.tagName == 'INPUT' || mezo.tagName == 'SELECT')
        if ((mezo.name != null) && (mezo.name != "")) {
          if ((mezo.type != null) && (mezo.type == "number")) dat[mezo.name] = mezo.value*1;
            else dat[mezo.name] = mezo.value;
        }
    }
    return dat;
  }
  
  var szamol = document.getElementById("szamol");
  szamol.addEventListener("click",function() {
    var dat = input_adatok();
    var uj_kulcs = adag_kulcs(dat);
    if (kulcs_index(uj_kulcs) < 0) { //nincs m√©g ilyen
      fetch("https://nuxi.hu/ken?_="+new Date().getTime(),{
        method: 'POST',
        body: JSON.stringify({fnct:csomag.fn.szamol,adatok:input_adatok()}),
        headers: new Headers({
          "Content-Type":"application/json; charset=UTF-8",
          "Cache-Control":"no-cache"
        })
      })
      .then(res => res.json())
      .then(json => {
        if (json.hiba == "") {
          dat.adag = json.adag;
          dat.sor = json.sor;
          adag_tarol(dat);
          if (szuro.value) {
            szuro_nullaz();
            adag_sorok();
          } else adag_sorok(dat);
          nev.value = "";
          szamol.disabled = true;
          talalat_db();
          talalat_db2();
        } else window.alert(json.hiba);
        kitakar();
        //nev.focus();
      })
      .catch(function(error) {
        window.alert(error);
      });
    } else window.alert(uj_kulcs+" m√°r szerepel a jegyzetben\nhaszn√°lj elt√©r≈ë nevet, ha m√°sik t√©tellel sz√°moln√°l");
  });

  function betakar() {
    if (betakarva) return;
    betakarva = true;
    overlay.style.display = "block";
    time_out = setTimeout(gebasz_eseten,6000);
  }

  function kitakar() {
    overlay.style.display = "none";
    clearTimeout(time_out);
    betakarva = false;
  }

  function gebasz_eseten() {
    kitakar();
    //rendben_befejez();
    setTimeout(function(){alert("sikertelen m≈±velet")},200);
  }

  function mit_valasztas(index) {
    var jelenleg = document.getElementById("jelenleg");
    if (csomag.mit_tb[index].nulla) {
      jelen.value = 0;
      jelen_r.value = 0;
      jelenleg.style.display = "none";
    } else jelenleg.style.display = "";
  }

  function mit_lista_gyarto() {
    var select = document.getElementById("mit");
    select.setAttribute("onchange","mit_valasztas(this.value)");
    for (var i = 0; i < csomag.mit_tb.length; i++) {
      var option = document.createElement("option");
      option.value = i;
      option.text = csomag.mit_tb[i].txt;
      select.appendChild(option);
    }
    select.value = 0;
  }

  function anyag_valasztas(index) {
    var tomeny = document.getElementById("tomeny");
    tomeny.value = csomag.anyag_tb[index].tomeny;
    tomeny_r.value = tomeny.value;
  }

  function anyag_lista_gyarto() {
    var select = document.getElementById("mivel");
    select.setAttribute("onchange","anyag_valasztas(this.value)");
    for (var i = 0; i < csomag.anyag_tb.length; i++) {
      var option = document.createElement("option");
      option.value = i;
      option.text = csomag.anyag_tb[i].txt;
      select.appendChild(option);
    }
    select.value = 0;
  }

  function cucc_jon() {
    var t = document.getElementById("tartalom");
    betakar();
    fetch("https://nuxi.hu/ken?_="+new Date().getTime(),{
      method: 'POST',
      body: JSON.stringify({fnct:0}),
      headers: new Headers({
        "Content-Type":"application/json; charset=UTF-8",
        "Cache-Control":"no-cache"
      })
    })
    .then(res => res.json())
    .then(json => {
      if (json.hiba == "") {
        csomag = {...json}
        var dtm = document.getElementById("dtm");
        dtm.value = csomag.dtm;
        var dt = document.getElementById("dt");
        dt.value = csomag.dt;
        mit_lista_gyarto();
        anyag_lista_gyarto();
        if (fejlec.innerHTML == "") fejlec.innerHTML = csomag.fejlec;
        helyben_tarolt_adatok_cookiebol();
        talalat_db(); //megfelel miatt
        var ertekel = document.getElementById("ertekel");
        ertekel.style.display = "";
      } else {
        t = document.getElementById("nincs_kapcsolat");
        window.alert(json.hiba);
      }
      t.style.display = "";
      kitakar();
      //nev.focus();
    })
    .catch(function(error) {
      t = document.getElementById("nincs_kapcsolat");
      t.style.display = "";
      window.alert(error);
    });
  }

  cucc_jon();
</script>
<script src="/fejezetek.js"></script>